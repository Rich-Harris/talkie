<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Heads &amp; Shoulders â€“ Talkie demo 02</title>
		<link rel="stylesheet" type="text/css" href="style.css">
		
		<script src="../lib/d3.v3.js"></script>
		<script src="../talkie-1.0.js"></script>
		
		<style>
			#display {
				width: 100%;
				height: 500px;
				text-align: center;
				font-size: 576px;
				font-weight: bold;
				line-height: 500px;
			}
			#stickman {
				width: 360px;
				height: 473px;
			}
		</style>
	</head>
	<body id="example-02-heads-shoulders">
		<div id="wrapper">
			<div id="display">
				<object id="stickman" data="media/02/stickman.svg" type="image/svg+xml" onload="init();"></object>
			</div>
		
			<div id="controls">
				<audio id="soundtrack" controls="controls">
					<source src="audio/02.heads-shoulders.ogg" type="audio/ogg">
					<source src="audio/02.heads-shoulders.mp3" type="audio/mpeg">
				</audio>
			</div>
		</div>
		
		<script>
			var soundtrack = document.getElementById("soundtrack");
			
			function init() {
				var stickman_object = document.getElementById("stickman"),
				    stickman_document = stickman_object.contentDocument,
				    stickman = d3.select(stickman_document).select("svg"),
				    stickman_anim = Talkie.animate(stickman_document.getElementById("stickman"))
				    left_arm  = stickman.select("#left-arm"),
				    right_arm = stickman.select("#right-arm"),
				    left_anim = Talkie.animate(left_arm.node()),
				    right_anim = Talkie.animate(right_arm.node());
			
				var d_l = left_arm.attr("d"), d_r = right_arm.attr("d"),
				    d_l_heads = stickman.select("#left-arm-heads").attr("d"),
				    d_r_heads = stickman.select("#right-arm-heads").attr("d"),
				    d_l_shoulders = stickman.select("#left-arm-shoulders").attr("d"),
				    d_r_shoulders = stickman.select("#right-arm-shoulders").attr("d"),
				    d_l_knees = stickman.select("#left-arm-knees").attr("d"),
				    d_r_knees = stickman.select("#right-arm-knees").attr("d"),
				    d_l_toes = stickman.select("#left-arm-toes").attr("d"),
				    d_r_toes = stickman.select("#right-arm-toes").attr("d"),
				    d_l_eyes = stickman.select("#left-arm-eyes").attr("d"),
				    d_r_eyes = stickman.select("#right-arm-eyes").attr("d"),
				    d_l_ears = stickman.select("#left-arm-ears").attr("d"),
				    d_r_ears = stickman.select("#right-arm-ears").attr("d"),
				    d_l_mouth = stickman.select("#left-arm-mouth").attr("d"),
				    d_r_mouth = stickman.select("#right-arm-mouth").attr("d"),
				    d_l_nose = stickman.select("#left-arm-nose").attr("d"),
				    d_r_nose = stickman.select("#right-arm-nose").attr("d");
				
				var eyes = Talkie.animate(stickman_document.getElementById("eyes")),
				    ears = Talkie.animate(stickman_document.getElementById("ears")),
				    mouth = Talkie.animate(stickman_document.getElementById("mouth")),
				    nose = Talkie.animate(stickman_document.getElementById("nose"));
			
				Talkie.timeline(soundtrack, [
					["0:00.10", function() {
						stickman_anim.attr("transform", "translate(-500 0)", "translate(500 0)", 2000);
					}],
					["0:02.60", function() {
						stickman_anim.attr("transform", "translate(500 0)", "translate(0 0)", 1000);
					}],
					["0:04.50", function() {
						stickman.select("#stickman").attr("transform", "translate(0 0)")
							.transition().duration(600).ease(function(t) {
								return 1 - Math.pow(2*t-1, 2);
							}).attr("transform", "translate(0 -100)");
					}],
					
					["0:06.00", function() {
						left_anim.attr("d", d_l, d_l_heads, 200);
						right_anim.attr("d", d_r, d_r_heads, 200);
					}],
					["0:06.50", function() {
						left_anim.attr("d", d_l_heads, d_l_shoulders, 200);
						right_anim.attr("d", d_r_heads, d_r_shoulders, 200);
					}],
					["0:07.20", function() {
						left_anim.attr("d", d_l_shoulders, d_l_knees, 200);
						right_anim.attr("d", d_r_shoulders, d_r_knees, 200);
					}],
					["0:07.70", function() {
						left_anim.attr("d", d_l_knees, d_l_toes, 200);
						right_anim.attr("d", d_r_knees, d_r_toes, 200);
					}],
					["0:08.20", function() {
						left_anim.attr("d", d_l_toes, d_l_knees, 200);
						right_anim.attr("d", d_r_toes, d_r_knees, 200);
					}],
					["0:08.70", function() {
						left_anim.attr("d", d_l_knees, d_l_toes, 200);
						right_anim.attr("d", d_r_knees, d_r_toes, 200);
					}],
					
					["0:09.00", function() {
						left_anim.attr("d", d_l_toes, d_l, 200);
						right_anim.attr("d", d_r_toes, d_r, 200);
					}],
					
					["0:10.00", function() {
						eyes.style("opacity", 0, 1, 100);
						left_anim.attr("d", d_l, d_l_eyes, 200);
						right_anim.attr("d", d_r, d_r_eyes, 200);
					}],
					["0:11.20", function() {
						ears.style("opacity", 0, 1, 100);
						left_anim.attr("d", d_l_eyes, d_l_ears, 200);
						right_anim.attr("d", d_r_eyes, d_r_ears, 200);
					}],
					["0:12.30", function() {
						mouth.style("opacity", 0, 1, 100);
						left_anim.attr("d", d_l_ears, d_l_mouth, 200);
						right_anim.attr("d", d_r_ears, d_r_mouth, 200);
					}],
					["0:13.50", function() {
						nose.style("opacity", 0, 1, 100);
						left_anim.attr("d", d_l_mouth, d_l_nose, 200);
						right_anim.attr("d", d_r_mouth, d_r_nose, 200);
					}],

					["0:14.00", function() {
						left_anim.attr("d", d_l_nose, d_l, 200);
						right_anim.attr("d", d_r_nose, d_r, 200);
					}],
					
					["0:14.30", function() {
						left_anim.attr("d", d_l, d_l_heads, 200);
						right_anim.attr("d", d_r, d_r_heads, 200);
					}],
					["0:15.10", function() {
						left_anim.attr("d", d_l_heads, d_l_shoulders, 200);
						right_anim.attr("d", d_r_heads, d_r_shoulders, 200);
					}],
					["0:15.90", function() {
						left_anim.attr("d", d_l_shoulders, d_l_knees, 200);
						right_anim.attr("d", d_r_shoulders, d_r_knees, 200);
					}],
					["0:16.40", function() {
						left_anim.attr("d", d_l_knees, d_l_toes, 200);
						right_anim.attr("d", d_r_knees, d_r_toes, 200);
					}],
					["0:16.90", function() {
						left_anim.attr("d", d_l_toes, d_l_knees, 200);
						right_anim.attr("d", d_r_toes, d_r_knees, 200);
					}],
					["0:17.40", function() {
						left_anim.attr("d", d_l_knees, d_l_toes, 200);
						right_anim.attr("d", d_r_knees, d_r_toes, 200);
					}],
					["0:18.00", function() {
						left_anim.attr("d", d_l_toes, d_l, 200);
						right_anim.attr("d", d_r_toes, d_r, 200);
						stickman_anim.attr("transform", "scale(1) translate(0 0)", "scale(1.8) translate(-165 -50)");
					}]
				]);
			}
		</script>
	</body>
</html>
